### 1. 퍼블렉서티

언어 모델의 '평가 방법'에 대해서 알아보자.

언어 모델은 주어진 과거 단어로부터 다음에 출현할 단어의 확률 분포를 출력한다.

이때 언어 모델의 예측 성능을 평가하는 척도로 **퍼블렉서티(Perplexity)** 를 자주 사용한다.

간단하게 '확률의 역수'라고 할 수 있다.

![[1. CNN LSTM 개념/image2/07.png]]

예를 들어, 'you say goodbye and I say hello .' 에서 'you' 다음으로 'say'가 나올 확률이 0.8이라고 분포되어있고 정답이 'say'라면, 이때의 확률은 0.8이다.

퍼플렉서티는 이 확률의 역수 1/(0.8) = 1.25라고 할 수 있다. 만약 say가 나올 확률이 0.2라고 나왔다면 퍼플렉서티는 5일 것이다. 퍼블렉시티는 작을수록 좋다는 것을 알 수 있다.

그렇다면 퍼블렉시티 값은 무슨 의미를 가지고 있는가? **'분기수'(number of branches)**  
로 해석할 수 있다.즉, 예측한 분기수가 1.25이면 'you'라는 단어 다음 출현할 후보가 1개로 좁혀졌다는 이야기이다.

분기수가 5이면, 다음 출현할 후보가 5개라는 의미이다.찍기전의 시험지의 5지선다 같은 느낌이다.
지금은 입력데이터가 하나일 때의 이야기이고 여러 개일 때는 다음 공식을 따른다.!

![[1. CNN LSTM 개념/image2/08.png|200]]

1) N : 데이터의 총 개수
2) t_n : 원핫 벡터로 나타낸 정답 레이블
3) t_nk : n 개째 데이터의 k번째 값을 의미
4) y_nk : 확률분포(신경망에서는 softmax의 출력)

눈치챈 사람도 있겠지만, 위의 L값은 교차 엔트로피 오차식과 완전히 같다. 퍼블렉서티는 L값을 이용해 exp 계산 해준 값이다.