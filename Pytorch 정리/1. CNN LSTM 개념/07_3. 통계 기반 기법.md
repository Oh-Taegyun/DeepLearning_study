통계 기반 기법을 살펴보기 전에 우리는 말뭉치를 알아야 한다. 

말뭉치란 간단히 말하면 대량의 텍스트 데이터이다. 다만 맹목적으로 수집된 텍스트 데이터가 아닌 자연어 처리 연구나 어플리케이션을 염두에 두고 수집된 텍스트 데이터를 일반적으로 ‘말뭉치’라고 한다. 

결국 말뭉치란 텍스트 데이터에 지나지 않지만, 그 안에 담긴 문장들은 사람이 쓴 글이다. 다른 시각에서 생각해보면, 말뭉치에는 자연어에 대한 사람의 ‘지식’이 충분히 담겨 있다고 볼 수 있다. 문장을 쓰는 방법, 단어를 선택하는 방법, 단어의 의미 등 사람이 알고 있는 자연어에 대한 지식이 포함되어 있는 것이다. 통계 기간 기법의 목표는 이처럼 사람의 지식으로 가득한 말뭉치에서 자동으로 그리고 효율적으로 그 핵심을 추출하는 것이다


### 3-2. 단어의 분산 표현
---
RGB 같은 벡터 표현은 단 세 가지 색의 성분으로 모든 색들을 더 정확하게 명시할 수 있다는 장점이 있다. 색끼리의 관련성도 벡터 표현으로 더 쉽게 판단하고 정량화할 수 있다.

그러면 '단어'도 '색'처럼 표현할 수 있을까? 보다 정확하게는, 간결하고 이치에 맞는 벡터 표현을 단어 영역에서도 구축할 수 있을까? 우리가 원하는 것은 '단어의 의미'를 정확하게 파악할 수 있는 벡터 표현이다. 자연어 처리 분야에서는 이를 단어의 '분산 표현'이라고 한다.


### 3-3. 분포 가설
---
![[1. CNN LSTM 개념/image/31.png]]

"단어의 의미는 주변 단어에 의해 형성된다"는 걸 분포 가설이라고 하며, 단어를 벡터로 표현하는 최근 연구 대부분이 이 가설을 바탕으로 한다.

분포 가설이 말하고자 하는 건 아주 간단하다. 단어 자체에 의미가 없고, 그 단어가 사용된 '맥락'이 의미를 형성한다는 거다.

위 그림처럼 '맥락'이란 특정 단어를 중심으로 한 그 주변 단어들을 말한다. 그리고 맥락의 크기(주변 단어를 몇 개나 포함할지)를 '윈도우 크기'라고 한다.

윈도우 크기가 1이면 좌우 한 단어씩이, 윈도우 크기가 2이면 좌우 두 단어씩이 맥락에 포함된다.\


### 3-4 동시발생 행렬
---
![[1. CNN LSTM 개념/image/32.png|500]]

분포 가설에 근거해 단어를 벡터로 나타내는 방법을 생각해 보자. 어떤 단어에 주목했을 때, 그 주변에 어떤 단어가 몇 번이나 등장하는지 세어 집계하는 방법이다. 이를 '통계 기반 기법'이라고 한다.

![[1. CNN LSTM 개념/image/33.png|500]]

위 표는 모든 단어에 대해 동시발생하는 단어를 표에 정리한 거다. 이 표의 각 행은 해당 단어를 표현한 벡터가 된다. 참고로 이 표가 행렬의 형태를 띠기 때문에 동시발생 행렬이라고 한다.


### 3-5. 상호 정보량
---
앞서 본 동시발생 행렬의 원소는 두 단어가 동시에 발생한 횟수를 나타낸다. 하지만, 단순히 '발생 횟수'는 그리 좋은 특징이 아니다. 특히 고빈도 단어(자주 나타나는 단어)의 경우 문제가 된다.

예를 들어, "the"와 "car"의 동시발생을 생각해보자. "the car"라는 문구는 자주 나타날 것이다. 그러나 "car"와 "drive"는 분명히 관련이 깊다. 단순 발생 횟수만 볼 때, "car"는 "drive"보다 "the"와의 관련성이 더 강하게 나타날 것이다, 왜냐하면 "the"가 고빈도 단어이기 때문이다. 이 문제를 해결하기 위해 점별 상호 정보량(PMI)이라는 척도를 사용한다.

![[34.png|200]]

PMI는 P(x)가 x가 일어날 확률, P(y)가 y가 일어날 확률, P(x, y)가 x와 y가 동시에 일어날 확률을 나타낸다. PMI 값이 높을수록 두 단어 사이의 관련성이 높다는 의미다.

![[35.png|400]]

C는 동시발생 행렬, C(x, y)는 단어 x와 y가 동시발생하는 횟수, C(x)와 C(y)는 각각 단어 x와 y의 등장 횟수다. 이때 말뭉치에 포함된 단어 수를 N이라고 하면, PMI는 특정 계산에 따라 결정된다.

이 방법으로 단어 간의 올바른 관련성을 평가할 수 있다. 이는 단어가 단독으로 나타나는 횟수를 고려하기 때문이다. 다만 두 단어의 동시 발생 횟수가 0일 경우 로그 값이 무한대가 되는 단점이 있어, 이를 피하기 위해 실제 구현 시 양의 상호 정보량(PPMI)를 사용한다.

